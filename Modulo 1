import csv

class Estoque:
    def __init__(self, nome_produto, quantidade_inicial, limite_minimo):
        self.nome_produto = nome_produto
        self.quantidade = quantidade_inicial
        self.limite_minimo = limite_minimo

    def receber_produto(self, quantidade):
        self.quantidade += quantidade
        self.atualizar_csv()
        print(f"Recebido {quantidade} de {self.nome_produto}. Estoque atual: {self.quantidade}")

    def vender_produto(self, quantidade):
        if self.quantidade >= quantidade:
            self.quantidade -= quantidade
            self.atualizar_csv()
            print(f"Vendido {quantidade} de {self.nome_produto}. Estoque atual: {self.quantidade}")
        else:
            print(f"Estoque insuficiente para vender {quantidade} de {self.nome_produto}.")

    def verificar_estoque(self):
        if self.quantidade <= self.limite_minimo:
            print(f"ALERTA: Estoque de {self.nome_produto} está abaixo do limite mínimo de {self.limite_minimo}!")

    def atualizar_csv(self):
        data = []

        with open('estoque.csv', 'r', newline='') as file:
            reader = csv.reader(file)
            for linha in reader:
                if linha and linha[0] == self.nome_produto and len(linha) >= 2:
                    linha[1] = str(self.quantidade)
                data.append(linha)

        with open('estoque.csv', 'w', newline='') as file:
            writer = csv.writer(file)
            for linha in data:
                writer.writerow(linha)


# estoque inicial xD

# caso 1 para criar produto e definir seu nome, quantidade e limite de aviso
gasolina = Estoque("Gasolina", 100, 20)
alcool = Estoque("Álcool", 80, 40)
diesel = Estoque("Diesel", 100, 20)
energia_solar = Estoque("Energia Solar", 50, 10)

# caso 2 em que deve ser usado em um laço de repitação e com limite predefinido de produtos (caso precise)
# nome = str(input('Insira nome do produto = '))
# quantidade = float(input('Insira quantidade inicial do produto = '))
# limite = int(input('Limite quantitativo para aviso ='))
# produto1 = Estoque(nome, quantidade, limite)

#exemplo de execução
gasolina.receber_produto(50)
gasolina.vender_produto(30)
gasolina.verificar_estoque()

energia_solar.vender_produto(60)
energia_solar.verificar_estoque()

alcool.vender_produto(60)
alcool.verificar_estoque()
